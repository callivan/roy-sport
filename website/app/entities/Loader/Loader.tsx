'use client';

import './loader.css';

import classNames from 'classnames';
import { useLayoutEffect, useRef, useState } from 'react';

export function Loader() {
  const logoRef = useRef<SVGSVGElement | null>(null);
  const containerRef = useRef<HTMLDivElement | null>(null);

  const [loading, setLoading] = useState<boolean>(true);

  useLayoutEffect(() => {
    if (!logoRef.current || !containerRef.current) return;

    const logo = logoRef.current;
    const lastPath = logo.querySelector<SVGPathElement>('path:last-of-type');
    const container = containerRef.current;

    if (!lastPath) return;

    lastPath.addEventListener('animationend', () => {
      container.classList.add('loaded');
    });

    logo.addEventListener('animationiteration', () => {
      typeof window !== 'undefined' && loading && setLoading(false);
    });
  }, [logoRef.current, containerRef.current]);

  return (
    <div
      ref={containerRef}
      className={classNames(
        // Custom class name
        'container',

        // Position
        'absolute top-[0px] left-[0px]',

        // Flex
        'flex items-center justify-center',

        // Size
        'w-full h-full',

        // Color
        'bg-white-900',

        // Layers
        'z-[1]',
      )}
    >
      <svg
        width="133"
        height="100"
        viewBox="0 0 32 24"
        fill="none"
        xmlns="http://www.w3.org/2000/svg"
        className={['logo-loader', loading ? 'loading' : 'loaded'].join(' ')}
        ref={logoRef}
      >
        <rect width="32" height="24" fill="white" />
        <path d="M9.5593 8.00009V2.90918H11.3739C11.7683 2.90918 12.0956 2.97712 12.3558 3.11301C12.6177 3.24891 12.8132 3.437 12.9425 3.67729C13.0717 3.91593 13.1364 4.19185 13.1364 4.50506C13.1364 4.81661 13.0709 5.09088 12.94 5.32786C12.8107 5.56318 12.6152 5.7463 12.3533 5.87722C12.0932 6.00814 11.7659 6.0736 11.3714 6.0736H9.9968V5.41238H11.3018C11.5504 5.41238 11.7526 5.37675 11.9084 5.30549C12.0658 5.23423 12.181 5.13065 12.2539 4.99476C12.3268 4.85887 12.3633 4.69564 12.3633 4.50506C12.3633 4.31283 12.326 4.14628 12.2514 4.00542C12.1785 3.86455 12.0633 3.75684 11.9059 3.68226C11.7501 3.60603 11.5455 3.56792 11.2919 3.56792H10.3274V8.00009H9.5593ZM12.0724 5.70321L13.3303 8.00009H12.4553L11.2223 5.70321H12.0724Z" />
        <path d="M15.5718 8.07715C15.2139 8.07715 14.9015 7.99512 14.6347 7.83105C14.3679 7.66699 14.1607 7.43747 14.0132 7.14249C13.8657 6.84751 13.792 6.50281 13.792 6.1084C13.792 5.71233 13.8657 5.36597 14.0132 5.06934C14.1607 4.7727 14.3679 4.54235 14.6347 4.37828C14.9015 4.21422 15.2139 4.13219 15.5718 4.13219C15.9298 4.13219 16.2422 4.21422 16.509 4.37828C16.7758 4.54235 16.9829 4.7727 17.1304 5.06934C17.2779 5.36597 17.3517 5.71233 17.3517 6.1084C17.3517 6.50281 17.2779 6.84751 17.1304 7.14249C16.9829 7.43747 16.7758 7.66699 16.509 7.83105C16.2422 7.99512 15.9298 8.07715 15.5718 8.07715ZM15.5743 7.45321C15.8063 7.45321 15.9986 7.3919 16.151 7.26927C16.3035 7.14663 16.4162 6.9834 16.4891 6.77956C16.5637 6.57573 16.6009 6.35118 16.6009 6.10591C16.6009 5.8623 16.5637 5.63858 16.4891 5.43475C16.4162 5.22926 16.3035 5.06436 16.151 4.94007C15.9986 4.81578 15.8063 4.75364 15.5743 4.75364C15.3406 4.75364 15.1468 4.81578 14.9926 4.94007C14.8402 5.06436 14.7267 5.22926 14.6521 5.43475C14.5792 5.63858 14.5427 5.8623 14.5427 6.10591C14.5427 6.35118 14.5792 6.57573 14.6521 6.77956C14.7267 6.9834 14.8402 7.14663 14.9926 7.26927C15.1468 7.3919 15.3406 7.45321 15.5743 7.45321Z" />
        <path d="M18.5212 9.43191C18.4102 9.43191 18.3091 9.42279 18.218 9.40456C18.1268 9.38799 18.0589 9.36976 18.0141 9.34988L18.1931 8.74086C18.329 8.77731 18.45 8.79306 18.556 8.78809C18.6621 8.78311 18.7557 8.74334 18.8369 8.66877C18.9198 8.59419 18.9927 8.47239 19.0557 8.30336L19.1476 8.0498L17.7506 4.18191H18.5461L19.5131 7.14498H19.5528L20.5198 4.18191H21.3177L19.7442 8.50968C19.6713 8.70854 19.5785 8.87675 19.4658 9.01429C19.3531 9.1535 19.2189 9.2579 19.0631 9.3275C18.9073 9.39711 18.7267 9.43191 18.5212 9.43191Z" />
        <path d="M10.3359 15.2465C10.3094 15.0112 10.2 14.8289 10.0078 14.6997C9.81558 14.5687 9.57363 14.5033 9.28196 14.5033C9.07315 14.5033 8.89252 14.5364 8.74006 14.6027C8.58759 14.6673 8.46911 14.7568 8.38459 14.8712C8.30173 14.9839 8.2603 15.1123 8.2603 15.2565C8.2603 15.3775 8.28847 15.4819 8.34482 15.5697C8.40282 15.6575 8.47822 15.7313 8.57102 15.7909C8.66548 15.8489 8.76657 15.8978 8.87429 15.9376C8.98201 15.9757 9.08558 16.0072 9.18501 16.032L9.68217 16.1613C9.84458 16.2011 10.0111 16.2549 10.1818 16.3229C10.3525 16.3908 10.5108 16.4803 10.6566 16.5914C10.8024 16.7024 10.9201 16.8399 11.0096 17.004C11.1007 17.1681 11.1463 17.3644 11.1463 17.5931C11.1463 17.8815 11.0717 18.1375 10.9226 18.3612C10.7751 18.585 10.5605 18.7615 10.2788 18.8907C9.9987 19.02 9.6598 19.0846 9.26207 19.0846C8.88092 19.0846 8.55114 19.0241 8.27273 18.9031C7.99432 18.7822 7.7764 18.6106 7.61896 18.3886C7.46153 18.1649 7.37453 17.8997 7.35795 17.5931H8.12855C8.14347 17.7771 8.20313 17.9304 8.30753 18.053C8.41359 18.174 8.54865 18.2643 8.71271 18.324C8.87843 18.382 9.0599 18.411 9.2571 18.411C9.47419 18.411 9.66726 18.377 9.83629 18.309C10.007 18.2394 10.1412 18.1433 10.239 18.0207C10.3368 17.8964 10.3857 17.7514 10.3857 17.5857C10.3857 17.4349 10.3426 17.3114 10.2564 17.2153C10.1719 17.1192 10.0567 17.0396 9.91087 16.9767C9.76669 16.9137 9.60346 16.8582 9.42116 16.8101L8.8196 16.646C8.41193 16.535 8.08878 16.3718 7.85014 16.1563C7.61316 15.9409 7.49467 15.6559 7.49467 15.3012C7.49467 15.0079 7.57422 14.7519 7.73331 14.5331C7.8924 14.3144 8.10784 14.1445 8.37962 14.0235C8.6514 13.9009 8.95798 13.8396 9.29936 13.8396C9.64406 13.8396 9.94815 13.9001 10.2116 14.021C10.4768 14.142 10.6856 14.3086 10.8381 14.5207C10.9905 14.7311 11.0701 14.9731 11.0767 15.2465H10.3359Z" />
        <path d="M12.0045 20.4319V15.1819H12.7304V15.8009H12.7925C12.8356 15.7213 12.8978 15.6294 12.979 15.5249C13.0602 15.4205 13.1729 15.3294 13.317 15.2515C13.4612 15.172 13.6518 15.1322 13.8888 15.1322C14.197 15.1322 14.4721 15.2101 14.714 15.3659C14.956 15.5216 15.1457 15.7462 15.2833 16.0395C15.4225 16.3328 15.4921 16.6858 15.4921 17.0985C15.4921 17.5111 15.4233 17.8649 15.2858 18.1599C15.1482 18.4532 14.9593 18.6794 14.719 18.8385C14.4787 18.9959 14.2045 19.0747 13.8962 19.0747C13.6642 19.0747 13.4745 19.0357 13.327 18.9578C13.1811 18.8799 13.0668 18.7888 12.9839 18.6844C12.9011 18.58 12.8373 18.4872 12.7925 18.406H12.7478V20.4319H12.0045ZM12.7329 17.091C12.7329 17.3595 12.7718 17.5948 12.8497 17.797C12.9276 17.9991 13.0403 18.1574 13.1878 18.2718C13.3353 18.3844 13.5159 18.4408 13.7297 18.4408C13.9517 18.4408 14.1373 18.382 14.2865 18.2643C14.4356 18.145 14.5483 17.9834 14.6246 17.7796C14.7024 17.5757 14.7414 17.3462 14.7414 17.091C14.7414 16.8391 14.7033 16.6129 14.627 16.4124C14.5525 16.2119 14.4398 16.0536 14.289 15.9376C14.1398 15.8216 13.9534 15.7636 13.7297 15.7636C13.5142 15.7636 13.3319 15.8191 13.1828 15.9301C13.0353 16.0412 12.9234 16.1961 12.8472 16.395C12.771 16.5938 12.7329 16.8258 12.7329 17.091Z" />
        <path d="M17.9331 19.0771C17.5752 19.0771 17.2628 18.9951 16.996 18.8311C16.7292 18.667 16.522 18.4375 16.3746 18.1425C16.2271 17.8475 16.1533 17.5028 16.1533 17.1084C16.1533 16.7123 16.2271 16.366 16.3746 16.0693C16.522 15.7727 16.7292 15.5423 16.996 15.3783C17.2628 15.2142 17.5752 15.1322 17.9331 15.1322C18.2911 15.1322 18.6035 15.2142 18.8703 15.3783C19.1371 15.5423 19.3443 15.7727 19.4917 16.0693C19.6392 16.366 19.713 16.7123 19.713 17.1084C19.713 17.5028 19.6392 17.8475 19.4917 18.1425C19.3443 18.4375 19.1371 18.667 18.8703 18.8311C18.6035 18.9951 18.2911 19.0771 17.9331 19.0771ZM17.9356 18.4532C18.1676 18.4532 18.3599 18.3919 18.5123 18.2693C18.6648 18.1466 18.7775 17.9834 18.8504 17.7796C18.925 17.5757 18.9623 17.3512 18.9623 17.1059C18.9623 16.8623 18.925 16.6386 18.8504 16.4347C18.7775 16.2293 18.6648 16.0644 18.5123 15.9401C18.3599 15.8158 18.1676 15.7536 17.9356 15.7536C17.702 15.7536 17.5081 15.8158 17.354 15.9401C17.2015 16.0644 17.088 16.2293 17.0134 16.4347C16.9405 16.6386 16.904 16.8623 16.904 17.1059C16.904 17.3512 16.9405 17.5757 17.0134 17.7796C17.088 17.9834 17.2015 18.1466 17.354 18.2693C17.5081 18.3919 17.702 18.4532 17.9356 18.4532Z" />
        <path d="M20.5426 19.0001V15.1819H21.261V15.7884H21.3008C21.3704 15.5829 21.493 15.4214 21.6687 15.3037C21.846 15.1844 22.0465 15.1247 22.2702 15.1247C22.3166 15.1247 22.3713 15.1264 22.4343 15.1297C22.4989 15.133 22.5495 15.1372 22.5859 15.1421V15.8531C22.5561 15.8448 22.5031 15.8357 22.4268 15.8257C22.3506 15.8141 22.2744 15.8083 22.1982 15.8083C22.0225 15.8083 21.8659 15.8456 21.7283 15.9202C21.5924 15.9931 21.4847 16.095 21.4052 16.2259C21.3256 16.3552 21.2859 16.5027 21.2859 16.6684V19.0001H20.5426Z" />
        <path d="M25.237 15.1819V15.7785H23.1515V15.1819H25.237ZM23.7108 14.2671H24.454V17.879C24.454 18.0232 24.4756 18.1317 24.5186 18.2046C24.5617 18.2759 24.6172 18.3248 24.6852 18.3513C24.7548 18.3762 24.8302 18.3886 24.9114 18.3886C24.9711 18.3886 25.0233 18.3844 25.068 18.3762C25.1127 18.3679 25.1475 18.3612 25.1724 18.3563L25.3066 18.9703C25.2636 18.9868 25.2022 19.0034 25.1227 19.02C25.0431 19.0382 24.9437 19.0481 24.8244 19.0498C24.6288 19.0531 24.4466 19.0183 24.2775 18.9454C24.1085 18.8725 23.9718 18.7598 23.8674 18.6073C23.763 18.4549 23.7108 18.2635 23.7108 18.0331V14.2671Z" />
        <path fillRule="evenodd" clipRule="evenodd" d="M30 12.0001H2V11.0001H30V12.0001Z" />
      </svg>
    </div>
  );
}
